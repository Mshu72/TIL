PHPの正規表現は、文字列のパターンマッチングや操作を行うための強力なツールです。正規表現は、特定のパターンに一致する文字列を検索、置換、抽出するために使用されます。PHPでは、主に2種類の正規表現関数が提供されています：

1. **POSIXスタイル関数（非推奨）**
2. **PCRE（Perl Compatible Regular Expressions）関数**

現在では、**PCRE関数**が主流であり、こちらを使うことが推奨されています。以下ではPCRE関数と基本的な正規表現の構文について解説します。

---

## **1. PHPで使う主なPCRE関数**

### 1.1 `preg_match()`  
文字列が正規表現パターンに一致するかを調べます。
```php
if (preg_match('/\d+/', '123abc')) {
    echo '数字が含まれています';
}
```

### 1.2 `preg_match_all()`  
文字列中の正規表現に一致するすべての部分を検索します。
```php
preg_match_all('/\d+/', 'abc123xyz456', $matches);
print_r($matches); // すべての一致結果が配列に入る
```

### 1.3 `preg_replace()`  
正規表現に一致する部分を置換します。
```php
echo preg_replace('/\d+/', '###', 'abc123xyz456'); // abc###xyz###
```

### 1.4 `preg_split()`  
正規表現を使って文字列を分割します。
```php
$result = preg_split('/,/', 'apple,banana,cherry');
print_r($result); // ['apple', 'banana', 'cherry']
```

### 1.5 `preg_replace_callback()`  
一致部分をコールバック関数で処理します。
```php
$text = 'abc123xyz';
$result = preg_replace_callback('/\d+/', function ($matches) {
    return intval($matches[0]) * 2; // 一致部分を2倍
}, $text);
echo $result; // abc246xyz
```

---

## **2. 正規表現の基本構文**

### 2.1 特殊文字
正規表現では、一部の文字には特別な意味があります。これらを「メタ文字」と呼びます。

| メタ文字 | 意味                     |
|----------|--------------------------|
| `.`      | 任意の1文字（改行以外）  |
| `\d`     | 数字（0-9）              |
| `\D`     | 数字以外                 |
| `\w`     | 単語構成文字（a-z, A-Z, 0-9, _）|
| `\W`     | 単語構成文字以外         |
| `\s`     | 空白文字（スペース、タブなど） |
| `\S`     | 空白文字以外             |

---

### 2.2 量指定子
量指定子を使って、特定のパターンが何回繰り返されるかを指定できます。

| 量指定子 | 意味                  |
|----------|-----------------------|
| `*`      | 0回以上の繰り返し     |
| `+`      | 1回以上の繰り返し     |
| `?`      | 0回または1回          |
| `{n}`    | n回の繰り返し         |
| `{n,}`   | n回以上の繰り返し     |
| `{n,m}`  | n回以上m回以下の繰り返し |

例：
```php
preg_match('/a{2,4}/', 'aaa', $matches);
print_r($matches); // 2〜4回繰り返される「a」が一致する
```

---

### 2.3 アンカー
アンカーを使うと、文字列の先頭や末尾を指定できます。

| アンカー  | 意味             |
|-----------|------------------|
| `^`       | 行の先頭を指定   |
| `$`       | 行の末尾を指定   |

例：
```php
preg_match('/^hello/', 'hello world'); // 一致
preg_match('/world$/', 'hello world'); // 一致
```

---

### 2.4 文字クラス
文字クラスを使うと、複数の候補から1文字を指定できます。

| 文字クラス      | 意味                           |
|-----------------|--------------------------------|
| `[abc]`         | a、b、c のいずれか1文字       |
| `[^abc]`        | a、b、c 以外の1文字           |
| `[a-z]`         | aからzまでの1文字（小文字）   |
| `[0-9]`         | 数字                          |

---

### 2.5 グループ化とキャプチャ
括弧を使うと、特定の部分をグループ化したりキャプチャできます。

#### グループ化：
```php
preg_match('/(abc)+/', 'abcabc', $matches);
print_r($matches); // 繰り返される "abc" をキャプチャ
```

#### キャプチャせずにグループ化（非キャプチャ）：
```php
preg_match('/(?:abc)+/', 'abcabc', $matches);
print_r($matches); // 非キャプチャ
```

---

## **3. 正規表現の応用例**

### 3.1 メールアドレスの検証
```php
$email = 'example@example.com';
if (preg_match('/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/', $email)) {
    echo '有効なメールアドレスです';
}
```

### 3.2 電話番号の検証
```php
$phone = '090-1234-5678';
if (preg_match('/^0\d{1,3}-\d{1,4}-\d{4}$/', $phone)) {
    echo '有効な電話番号です';
}
```

### 3.3 URLの検証
```php
$url = 'https://example.com';
if (preg_match('/^https?:\/\/[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}(\/.*)?$/', $url)) {
    echo '有効なURLです';
}
```

---

正規表現は非常に柔軟で強力ですが、複雑になりがちなので、必要に応じてテストしながら使うのがポイントです。また、[PHPの公式ドキュメント](https://www.php.net/manual/ja/ref.pcre.php)も参考にすると便利です！
