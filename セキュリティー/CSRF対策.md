CSRF（Cross-Site Request Forgery、クロスサイトリクエストフォージェリ）は、ユーザーが認証された状態を悪用し、意図しないリクエストを強制的に実行させる攻撃です。攻撃者は信頼されたユーザーになりすまして、不正な操作を行います。

### 例
1. ユーザーが銀行のサイトにログインし、アカウント管理画面を開いたままにする。  
2. 攻撃者が用意した悪意のあるリンクをクリックすると、ユーザーの意図に反して送金リクエストが自動的に送信される。

---

## CSRF対策方法

### 1. **CSRFトークンの導入**  
- フォームやリクエストに**ワンタイムトークン**（一意な識別子）を埋め込む。  
- サーバーは、リクエスト受信時にこのトークンが正しいか確認。  
- トークンがない、または不一致ならリクエストを拒否。

**実装例（Spring Boot）：**
```html
<form action="/transfer" method="post">
    <input type="hidden" name="_csrf" value="${_csrf.token}" />
    <input type="text" name="amount" />
    <button type="submit">送金</button>
</form>
```

---

### 2. **SameSite属性の設定（Cookie）**  
- クッキーの`SameSite`属性を`Strict`または`Lax`に設定。  
- 他サイトからのリクエストでは、クッキーが送信されないためCSRF攻撃を防止。

**例：**
```
Set-Cookie: sessionid=abc123; Secure; HttpOnly; SameSite=Strict
```

---

### 3. **Refererチェック**  
- リクエストの`Referer`ヘッダーを確認し、正規のドメインからのリクエストのみ受け付ける。

---

### 4. **ユーザーの再認証**  
- 重要な操作（送金やパスワード変更）では、再度パスワード入力を求める。

---

### 5. **CORS（Cross-Origin Resource Sharing）の制限**  
- クロスオリジンのリクエストを制限し、不正なサイトからのリクエストを拒否。

---

### CSRF対策が必要な理由
- **ユーザーの意図しない操作を防ぐ。**  
- **機密情報の保護。**  
- **セキュリティ事故のリスク低減。**  

RailsやSpring Bootなどの主要フレームワークでは、デフォルトでCSRF対策が組み込まれていますが、設定が適切であるか定期的に確認することが重要です。
